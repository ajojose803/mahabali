<%- include('../partials/userHeader')-%>

<style>
    .shop__sidebar {
        padding: 20px;
    }

    .contact__content ul {
        list-style-type: none;
        padding: 0;
    }

    .contact__content ul a {
        display: block;
        padding: 10px;
        text-decoration: none;
        color: black;
        border-bottom: 1px solid #ddd;
    }

    .contact__content ul a.active {
        background-color: #c91414;
        color: white;
    }

    .contact__content ul a:hover {
        background-color: #f0f0f0;
    }

    .form-container {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .form-container h2 {
        margin-bottom: 20px;
        font-size: 24px;
        color: #333;
        text-align: center;
    }

    .form-group {
        margin-bottom: 15px;
    }

    .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #555;
    }

    .form-group input {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }

    .form-group input[readonly] {
        background-color: #f9f9f9;
    }

    .checkout__form__input input:focus {
        border-color: #c91414;
        outline: none;
    }

    .site-btn-container {
        text-align: center;
    }

    .site-btn {
        padding: 12px 25px;
        background-color: #c91414;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }

    .site-btn:hover {
        background-color: #811111;
    }

    .form-group label {
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: normal;
        cursor: pointer;
    }

    .form-group label input[type="checkbox"] {
        margin-right: 10px;
    }

    .error-message {
        color: red;
        font-size: 14px;
        margin-top: 5px;
    }

    .error {
        border-color: red; /* Adjust styling to indicate errors */
    }
</style>

<!-- Breadcrumb Begin -->
<div class="breadcrumb-option">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb__links">
                    <a href="/"><i class="fa fa-home"></i> Home</a>
                    <a href="/profile">My Account</a>
                    <a href="/profile">Address</a>
                    <span> Add Address</span>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Breadcrumb End -->

<!-- Contact Section Begin -->
<section class="spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-3">
                <div class="shop__sidebar">
                    <!-- Filter Sidebar -->
                    <div class="contact__content">
                        <h5>My Account</h5>
                        <br>
                        <ul>
                            <li><a href="/profile/"><span class="fa fa-info-circle" style="margin-right: 10px;"></span> Personal Information</a></li>
                            <li><a href="/profile/address" class="active"><span class="fa fa-address-card" style="margin-right: 10px;"></span> Address</a></li>
                            <li><a href="/profile/orders"><span class="fa fa-shopping-bag" style="margin-right: 10px;"></span> Orders</a></li>
                            <li><a href="/profile/wallet"><span class="fa fa-credit-card" style="margin-right: 10px;"></span> Wallet</a></li>
                            <li><a href="/profile/change-password"><span class="fa fa-key" style="margin-right: 10px;"></span> Change Password</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-lg-9 col-md-9">
                <div class="form-container">
                    <h2>Add Address</h2>
                    <form id="addressForm" action="/profile/address/new" method="POST" class="checkout__form">
                        <!-- Address fields with updated structure -->
                        <div class="checkout__form__input">
                            <p>First Name <span>*</span></p>
                            <input type="text" id="firstName" name="firstName" placeholder="First Name" required>
                            <div id="firstNameError" class="error-message"></div>
                        </div>

                        <div class="checkout__form__input">
                            <p>Last Name <span>*</span></p>
                            <input type="text" id="lastName" name="lastName" placeholder="Last Name" required>
                            <div id="lastNameError" class="error-message"></div>
                        </div>

                        <div class="checkout__form__input">
                            <p>Phone <span>*</span></p>
                            <input type="number" id="phone" name="phone" placeholder="Phone Number" required>
                            <div id="phoneError" class="error-message"></div>
                        </div>

                        <div class="checkout__form__input">
                            <p>Email <span>*</span></p>
                            <input type="email" id="email" name="email" placeholder="Email" required>
                            <div id="emailError" class="error-message"></div>
                        </div>

                        <div class="checkout__form__input">
                            <p>Address Line 1 <span>*</span></p>
                            <input type="text" id="addressline1" name="addressline1" placeholder="Address Line 1" required>
                            <div id="addressline1Error" class="error-message"></div>
                        </div>

                        <div class="checkout__form__input">
                            <p>Address Line 2</p>
                            <input type="text" id="addressline2" name="addressline2" placeholder="Address Line 2">
                            <div id="addressline2Error" class="error-message"></div>
                        </div>

                        <div class="checkout__form__input">
                            <p>City <span>*</span></p>
                            <input type="text" id="city" name="city" placeholder="City" required>
                            <div id="cityError" class="error-message"></div>
                        </div>

                        <div class="checkout__form__input">
                            <p>State <span>*</span></p>
                            <input type="text" id="state" name="state" placeholder="State" required>
                            <div id="stateError" class="error-message"></div>
                        </div>

                        <div class="checkout__form__input">
                            <p>Country <span>*</span></p>
                            <input type="text" id="country" name="country" placeholder="Country" required>
                            <div id="countryError" class="error-message"></div>
                        </div>

                        <div class="checkout__form__input">
                            <p>Pincode <span>*</span></p>
                            <input type="number" id="pincode" name="pincode" placeholder="Pincode" oninput="this.value=this.value.slice(0,6)" required >
                            <div id="pincodeError" class="error-message"></div>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="setDefault" name="setDefault">
                            <label class="form-check-label" for="setDefault">
                                Make this my default address
                            </label>
                        </div>

                        <!-- Add Address Button -->
                        <div class="site-btn-container">
                            <button type="submit" class="site-btn">Add Address</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('addressForm');
        const inputs = form.querySelectorAll('input, select, textarea');

        // Regular expressions for validation
        const nameRegex = /^[a-zA-Z\s]*$/; // Alphabets and spaces only
        const phoneRegex = /^[0-9]{10}$/; // 10 digits only
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; // Proper email format
        const pincodeRegex = /^[0-9]{6}$/; // 6 digits only

        // Function to validate a single field
        function validateField(field) {
            const errorElement = document.getElementById(field.id + 'Error');
            let isValid = true;

            switch (field.id) {
                case 'firstName':
                case 'lastName':
                    isValid = nameRegex.test(field.value.trim());
                    break;
                case 'phone':
                    isValid = phoneRegex.test(field.value.trim());
                    break;
                case 'email':
                    isValid = emailRegex.test(field.value.trim());
                    break;
                case 'pincode':
                    isValid = pincodeRegex.test(field.value.trim());
                    break;
                default:
                    isValid = field.value.trim() !== '';
            }

            if (!isValid) {
                switch (field.id) {
                    case 'firstName':
                    case 'lastName':
                        errorElement.textContent = 'Please enter alphabets and spaces only.';
                        break;
                    case 'phone':
                        errorElement.textContent = 'Please enter a valid 10-digit phone number.';
                        break;
                    case 'email':
                        errorElement.textContent = 'Please enter a valid email address.';
                        break;
                    case 'pincode':
                        errorElement.textContent = 'Please enter a valid 6-digit pincode.';
                        break;
                    default:
                        errorElement.textContent = 'This field is required.';
                }
                field.classList.add('error');
            } else {
                errorElement.textContent = '';
                field.classList.remove('error');
            }

            return isValid;
        }

        // Validate field on blur
        inputs.forEach(input => {
            input.addEventListener('blur', function() {
                validateField(input);
            });
        });

        // Validate entire form on submit
        form.addEventListener('submit', function(event) {
            let isValid = true;
            inputs.forEach(input => {
                if (!validateField(input)) {
                    isValid = false;
                }
            });

            if (!isValid) {
                event.preventDefault(); // Prevent form submission if validation fails
                event.stopPropagation();
            }
        });
    });
</script>

<%- include('../partials/userFooter')-%>